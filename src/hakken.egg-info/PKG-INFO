Metadata-Version: 2.4
Name: hakken
Version: 0.1.0
Summary: a agent which need too much context
Author-email: Saurabh <your-email@example.com>
License: MIT
Keywords: ai,agent,conversation,cli
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: python-dotenv>=0.9.9
Requires-Dist: openai>=1.106.0
Requires-Dist: rich>=14.1.0
Dynamic: license-file

# Hakken - Component-Wise AI Agent

A clean, component-based reimplementation of the Quick Star CLI agent system from Chapter 7, featuring proper dependency injection and modular architecture.

## Architecture Overview

### ğŸ—ï¸ Component-Based Design

Unlike the original singleton-based approach, Hakken uses **clean component separation** with **dependency injection**:

```
ğŸ“¦ hakken/src/
â”œâ”€â”€ ğŸ¤– agent/           # Main conversation coordination
â”œâ”€â”€ ğŸŒ client/          # API client components  
â”œâ”€â”€ ğŸ“š history/         # Conversation history management
â”œâ”€â”€ ğŸ’¬ interface/       # User interface components
â”œâ”€â”€ ğŸ› ï¸ tools/           # Tool implementations
â”œâ”€â”€ ğŸ’­ prompt/          # Prompt management
â””â”€â”€ ğŸ“„ main.py          # Entry point
```

### ğŸ”„ Key Improvements

#### âœ… **Component-Wise Benefits**
- **Testable**: Each component can be tested independently
- **Maintainable**: Clear separation of responsibilities  
- **Readable**: Easy to understand what each component does
- **Flexible**: Components can be swapped or extended easily
- **No Hidden State**: All dependencies are explicit

#### âŒ **Original Singleton Problems Fixed**
- ~~Hard to test~~ â†’ **Easy to test with dependency injection**
- ~~Hidden dependencies~~ â†’ **Explicit component interfaces**
- ~~Tight coupling~~ â†’ **Loose coupling through interfaces**
- ~~Global state~~ â†’ **Clean component state management**

## ğŸš€ Installation

```bash
cd hakken
pip install -e .
```

## âš™ï¸ Configuration

Create `.env` file in project root:
```bash
OPENAI_API_KEY=your_api_key_here
OPENAI_BASE_URL=https://openrouter.ai/api/v1
OPENAI_MODEL=anthropic/claude-sonnet-4
MODEL_MAX_TOKENS=200
COMPRESS_THRESHOLD=0.8
```

## ğŸƒâ€â™‚ï¸ Usage

```bash
hakken
```

## ğŸ“‹ Component Details

### ğŸ¤– Agent (`agent/conversation_agent.py`)
- **Main coordinator** for all components
- **Clean dependency injection** - no singletons
- **Exact same functionality** as Chapter 7 but organized better

### ğŸŒ API Client (`client/openai_client.py`) 
- **Configuration-driven** OpenAI client
- **Cost tracking** and **streaming support**
- **Environment-based configuration**

### ğŸ“š History Manager (`history/conversation_history.py`)
- **Conversation history** with **auto-compression**
- **Token usage tracking** and **context window management**
- **Message cropping** capabilities

### ğŸ’¬ User Interface (`interface/user_interface.py`)
- **Clean separation** of input and display
- **Rich formatting** with streaming support
- **Modular components**: `InputHandler` + `DisplayManager`

### ğŸ› ï¸ Tools (`tools/`)
- **`ToolInterface`**: Clean base interface for all tools
- **`ToolRegistry`**: Manages tool instances without singletons
- **Four main tools**:
  - `CommandRunner`: Execute shell commands
  - `TodoWriteManager`: Task management
  - `ContextCropper`: History management
  - `TaskDelegator`: Sub-agent delegation

### ğŸ’­ Prompt Manager (`prompt/prompt_manager.py`)
- **Environment collection** and **system rules**
- **Modular prompt building** with clean interfaces
- **Tool-aware reminders**

## ğŸ”§ Key Features

### âœ¨ **Same Functionality as Chapter 7**
- âœ… Streaming conversations with token tracking
- âœ… Tool calls with user approval
- âœ… History compression and context management  
- âœ… Sub-agent task delegation
- âœ… Todo list management
- âœ… Smart context cropping
- âœ… Beautiful CLI interface

### ğŸ—ï¸ **Better Architecture**
- âœ… **No Singletons** - Clean dependency injection
- âœ… **Component Separation** - Each component has clear responsibility
- âœ… **Testable Design** - Easy to unit test individual components
- âœ… **Maintainable Code** - Easy to modify and extend
- âœ… **Clear Dependencies** - No hidden coupling between components

## ğŸ†š Comparison with Original

| Aspect | Original (Chapter 7) | Hakken (Component-wise) |
|--------|----------------------|-------------------------|
| **Architecture** | Singleton-based | Component-based |
| **Dependencies** | Hidden/Global | Explicit injection |
| **Testing** | Difficult | Easy |
| **Maintainability** | Complex | Simple |
| **Code Clarity** | Scattered logic | Clear separation |
| **Functionality** | âœ… Full features | âœ… **Exact same features** |

## ğŸ§ª Testing

Each component can be tested independently:

```python
# Example: Testing API client
from client.openai_client import APIClient, APIConfiguration

config = APIConfiguration("test-key", "test-url", "test-model")
client = APIClient(config)
# Test client independently
```

## ğŸ”® Extensibility

Adding new components is straightforward:

```python
# 1. Create new tool
class MyNewTool(ToolInterface):
    def get_tool_name(self): return "my_tool"
    async def act(self, **kwargs): return "result"
    # ... implement other methods

# 2. Register in agent
agent = ConversationAgent()
agent.tool_registry.register_tool(MyNewTool())
```

## ğŸ“ Summary

**Hakken provides the exact same functionality as Chapter 7** but with a **much cleaner, more maintainable architecture**:

- ğŸ¯ **Same Features**: All tools, streaming, history management, sub-agents
- ğŸ—ï¸ **Better Design**: Component-based instead of singleton-based  
- ğŸ§ª **Testable**: Each component can be tested independently
- ğŸ“– **Readable**: Clear separation of concerns and dependencies
- ğŸ”§ **Maintainable**: Easy to modify and extend individual components

Perfect for learning clean architecture patterns while maintaining full agent functionality!
